import json 
from datetime import datetime
search_ids = ["hdfc-mid-cap-fund-direct-growth",
 "kotak-emerging-equity-scheme-direct-growth",
 "nippon-india-growth-mid-cap-fund-direct-growth",
 "motilal-oswal-most-focused-midcap-30-fund-direct-growth",
 "axis-midcap-fund-direct-growth",
 "sbi-mid-cap-direct-plan-growth",
 "dsp-blackrock-small-and-midcap-fund-direct-growth",
 "edelweiss-mid-and-small-cap-fund-direct-growth",
 "sundaram-select-midcap-direct-growth",
 "franklin-india-mid-cap-fund-direct-growth",
 "hsbc-midcap-fund-direct-growth",
 "uti-mid-cap-fund-direct-growth",
 "pgim-india-midcap-fund-direct-growth",
 "invesco-india-mid-cap-fund-direct-growth",
 "quant-mid-cap-fund-direct-growth",
 "icici-prudential-midcap-fund-direct-growth",
 "birla-sun-life-mid-cap-fund-plan-a-direct-growth",
 "tata-mid-cap-direct-plan-growth",
 "whiteoak-capital-mid-cap-fund-direct-growth",
 "mahindra-manulife-mid-cap-fund-direct-growth",
 "canara-robeco-mid-cap-fund-direct-growth",
 "baroda-bnp-paribas-midcap-fund-direct-growth",
 "nippon-india-nifty-midcap-150-index-fund-direct-growth",
 "bandhan-midcap-fund-direct-growth",
 "union-midcap-fund-direct-growth",
 "edelweiss-nifty-midcap150-momentum-50-index-fund-direct-growth",
 "iti-mid-cap-fund-direct-growth",
 "jm-midcap-fund-direct-growth",
 "tata-nifty-midcap-150-momentum-50-index-fund-direct-growth",
 "icici-prudential-nifty-midcap-150-index-fund-direct-growth",
 "sbi-nifty-midcap-150-index-fund-direct-growth",
 "axis-nifty-midcap-50-index-fund-direct-growth",
 "hdfc-nifty-midcap-150-index-fund-direct-growth",
 "dsp-nifty-midcap-150-quality-50-index-fund-direct-growth",
 "aditya-birla-sun-life-nifty-midcap-150-index-fund-direct-growth",
 "navi-nifty-midcap-150-index-fund-direct-growth",
 "lic-mf-midcap-fund-direct-growth",
 "mirae-asset-nifty-midsmallcap400-momentum-quality-100-etf-fof-direct-growth",
 "uti-nifty-midcap-150-quality-50-index-fund-direct-growth",
 "tata-nifty-midcap-150-index-fund-direct-growth",
 "taurus-mid-cap-fund-direct-growth",
 "uti-nifty-midsmallcap-400-momentum-quality-100-index-fund-direct-growth",
 "uti-nifty-midcap-150-index-fund-direct-growth",
 "kotak-nifty-midcap-150-index-fund-direct-growth",
 "navi-nifty-midsmallcap-400-index-fund-direct-growth",
 "dsp-nifty-midcap-150-index-fund-direct-growth",
 "mirae-asset-midcap-fund-direct-growth",
 "motilal-oswal-nifty-midcap-150-index-fund-direct-growth"] 



result = []
for search_id in search_ids:
  fetch(f'https://groww.in/mutual-funds/{search_id}')

  stock = response.xpath("/html/body/div[1]/div[2]/div[2]/div/div[1]/div/div/div[1]/div[1]/section[2]/div/table/tbody/tr/td/a/span/text()").getall()

  sector = response.xpath("/html/body/div[1]/div[2]/div[2]/div/div[1]/div/div/div[1]/div[1]/section[2]/div/table/tbody/tr/td[2]/text()").getall()

  instruments = response.xpath("/html/body/div[1]/div[2]/div[2]/div/div[1]/div/div/div[1]/div[1]/section[2]/div/table/tbody/tr/td[3]/text()").getall()

  assets = response.xpath("/html/body/div[1]/div[2]/div[2]/div/div[1]/div/div/div[1]/div[1]/section[2]/div/table/tbody/tr/td[4]/text()").getall()

  for i in range(len(stock)):
     result.append({"stock": stock[i], "sector": sector[i], "instruments": instruments[i], "assets": assets[i], "mutual fund": search_id})

with open("%s_mid_cap_mutualfund_invested_companies.json" % (datetime.now().strftime('%d_%m_%Y')), "w") as outfile: 
    json.dump(result, outfile)


ruby
----------------
def asset_value(record)
  record["assets"].to_s.strip.delete("%,").to_f
end

#Read File
file = File.read('08_02_2026_mid_cap_mutualfund_invested_companies.json')
require 'json'
data = JSON.parse(file)
grouped = data
  .group_by { |i| i["sector"] }
  .transform_values do |items|
    items
      .group_by { |i| i["stock"] }
      .transform_values do |records|
        records.sort_by { |r| -asset_value(r) }
      end
  end

result = data
  .group_by { |i| i["sector"] }
  .transform_values do |sector_records|
    stocks = sector_records
      .group_by { |r| r["stock"] }
      .transform_values do |stock_records|
        values = stock_records.map { |r| asset_value(r) }

        avg = (values.sum / values.size.to_f).round(2)
        min = values.min
        max = values.max

        {
          average: "#{avg}%",
          min: "#{min}%",
          max: "#{max}%",
          count: values.size,
          mutual_funds: stock_records.map do |r|
            {
              name: r["mutual fund"],
              asset: "#{asset_value(r)}%"
            }
          end
        }
      end

    {
      stocks: stocks
        .sort_by { |_, v| -v[:count] }
        .to_h
    }
  end


#-----------------------------------------------------------------------------
File.open("mid_cap_stocks_by_mutual_funds.json", "w") do |file|
  file.write(grouped.to_json)
end

File.open("mid_cap_by_mutual_funds_avg_coung.json", "w") do |file|
  file.write(result.to_json)
end